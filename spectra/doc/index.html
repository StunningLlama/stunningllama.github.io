<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head> <title>Rendering the Visible Spectrum</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='Spectra.css' rel='stylesheet' type='text/css' /> 
<meta content='Spectra.tex' name='src' /> 
<script>window.MathJax = {}</script> 
<script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js' type='text/javascript'></script>  
 
<script src='mathjaxconfig.js' type='text/javascript'></script> 
</head>

<style>
        #menu-bar {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f8f8f8;
            color: #333;
            text-align: center;
            background-color: #333;
            overflow: hidden;
        }

        #menu-bar a {
            float: left;
            display: block;
            color: #f2f2f2;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
        }

        #menu-bar a:hover {
            background-color: #ddd;
            color: black;
        }
</style><body>

<div id="menu-bar">
    <a href="../index.html">Home</a>
</div>

<p>
   \( %Gen math
\newcommand{\problem}[1]{\subsection*{#1}}
\newcommand{\pt}[1]{\paragraph{(#1)}}
\newcommand{\spc}{\text{ }}
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\A}{\mathbb{A}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\I}{\mathbb{I}}
\newcommand{\HA}{\mathbb{H}}
\newcommand{\SA}{\mathbb{S}}
\newcommand{\beq}{\begin{equation}}
\newcommand{\eeq}{\end{equation}}
\newcommand{\bmt}{\begin{bmatrix}}
\newcommand{\bmtl}[1]{\begin{array}{#1}}
\newcommand{\emt}{\end{bmatrix}}
\newcommand{\rank}{\operatorname{rank}}
\newcommand{\re}{\operatorname{Re}}
\newcommand{\im}{\operatorname{Im}}
\newcommand{\img}{\operatorname{im}}
\newcommand{\trace}{\operatorname{tr}}
\newcommand{\ad}{\operatorname{ad}}
\newcommand{\Ad}{\operatorname{Ad}}
\newcommand{\Aut}{\operatorname{Aut}}
\newcommand{\adj}{\operatorname{adj}}
\newcommand{\spanl}{\operatorname{span}}
\newcommand{\Hom}{\operatorname{Hom}}
\newcommand{\id}{\operatorname{id}}
\newcommand{\Id}{\operatorname{Id}}
\newcommand{\twomat}[4]{\bmt #1 &amp; #2 \\ #3 &amp; #4 \emt}
\newcommand{\rref}{\operatorname{rref}}
\newcommand{\Det}{\operatorname{Det}}
\newcommand{\supp}{\operatorname{supp}}
\newcommand{\GL}{\operatorname{GL}}
\newcommand{\SU}{\operatorname{SU}}
\newcommand{\SO}{\operatorname{SO}}
\newcommand{\SL}{\operatorname{SL}}
\newcommand{\U}{\operatorname{U}}
\newcommand{\pr}{\operatorname{pr}}
\newcommand{\sff}{\operatorname{II}}
\newcommand{\Res}{\operatorname{Res}}
\newcommand{\Var}{\operatorname{Var}}
\newcommand{\CNOT}{\operatorname{CNOT}}

\newcommand{\btab}{
\begin{table}[h]
\centering
\begin{tabular}{ccc}
}

\newcommand{\etab}{
\end{tabular}
\end{table}
}

\newcommand{\mathdiagram}[3]{
\begin{figure}[h!]
    \centering
    \includegraphics[scale=#2]{mathdiagram/#1}
    \caption{#3}
\end{figure}
}

\newcommand{\wrapdiagram}[3]{
\begin{wrapfigure}{r}{0.5\textwidth}
    \centering
    \includegraphics[scale=#2]{mathdiagram/#1}
    \caption{#3}
\end{wrapfigure}
}

\newcommand{\stack}[2]{\stackrel{\text{#1}}{#2}}
%Phys
\newcommand{\op}[1]{\operatorname{#1}}
\newcommand{\vecd}[2]{#1 \vh{i} + #2 \vh{j}}
\newcommand{\vecdm}[2]{#1 \vh{i} - #2 \vh{j}}
\newcommand{\vect}[3]{#1 \vh{i} + #2 \vh{j} + #3 \vh{k}}
\newcommand{\va}[1]{{\boldsymbol{#1}}}
\newcommand{\vh}[1]{\hat{\mathbf{#1}}}
\newcommand{\mb}[1]{\mathbf{#1}}
\newcommand{\px}[1]{\frac{\partial #1}{\partial x}}
\newcommand{\py}[1]{\frac{\partial #1}{\partial y}}
\newcommand{\pz}[1]{\frac{\partial #1}{\partial z}}
\newcommand{\partialt}[1]{\frac{\partial #1}{\partial t}}
\newcommand{\D}[1]{\operatorname{d #1}}
\newcommand{\sgn}{\operatorname{sgn}}
\newcommand{\T}[1]{\text{#1}}
\newcommand{\VE}{\vec{\mathbf{E}}}
\newcommand{\VB}{\vec{\mathbf{B}}}
\newcommand{\VA}{\vec{\mathbf{A}}}
\newcommand{\pd}[2]{\left(\frac{\partial #1}{\partial #2}\right)}

\newcommand{\diagram}[2]{
\begin{figure}[H]
    \centering
    \includegraphics[scale=#2]{#1}
\end{figure}
}

\newcommand{\diagramb}[3]{
\begin{figure}[H]
    \centering
    \includegraphics[scale=#2]{#1}
    \caption{#3}
\end{figure}
}

\newcommand{\physdiagram}[2]{
\begin{figure}[h!]
    \centering
    \includegraphics[scale=#2]{physdiagram/#1}
    \caption{Diagram}
\end{figure}
}

\newcommand{\physdiagramb}[3]{
\begin{figure}[h!]
    \centering
    \includegraphics[scale=#2]{physdiagram/#1}
    \caption{#3}
\end{figure}
}

\newcommand{\physdiagrambb}[6]{
\begin{figure}[h!]
  \centering
  \begin{minipage}[b]{0.45\textwidth}
    \includegraphics[scale=#2]{physdiagram/#1}
    \caption{#5}
  \end{minipage}
  \hfill
  \begin{minipage}[b]{0.45\textwidth}
    \includegraphics[scale=#4]{physdiagram/#3}
    \caption{#6}
  \end{minipage}
\end{figure}
}



\newcommand{\doublefigure}[5]{
\begin{figure}[h!]
\centering
\begin{minipage}{.5\textwidth}
  \centering
  \includegraphics[#2]{wavediagram/#1}
\end{minipage}%
\begin{minipage}{.5\textwidth}
  \centering
  \includegraphics[#4]{wavediagram/#3}
\end{minipage}
  \caption{#5}
\end{figure}
}

\newcommand{\doublefiguretwo}[5]{
\begin{figure}[p]
        \centering
  \begin{subfigure}[b]{0.4\textwidth}
    \centering
    \includegraphics[scale=#2]{wavediagram/#1}
  \end{subfigure}
  \hfill
  \begin{subfigure}[b]{0.4\textwidth}im
    \centering
    \includegraphics[scale=#4]{wavediagram/#3}
            \begin{minipage}{.1cm}
            \vfill
            \end{minipage}
  \end{subfigure}
  \caption{#5}
\end{figure}
}

\newcommand{\wavediagram}[3]{
\begin{figure}[h!]
    \centering
    \includegraphics[scale=#2]{wavediagram/#1}
    \caption{#3}
\end{figure}
}

\newcommand{\xhat}{\hat{x}}
\newcommand{\yhat}{\hat{y}}
\newcommand{\zhat}{\hat{z}}
\newcommand{\rhat}{\hat{r}}
\newcommand{\thetahat}{\hat{\theta}}
\newcommand{\phihat}{\hat{\varphi}}
\newcommand{\phat}{\hat{p}}
\newcommand{\Hhat}{\hat{H}}
\newcommand{\That}{\hat{T}}
\newcommand{\Ohat}{\hat{O}}
\newcommand{\Nhat}{\hat{N}}
\newcommand{\Rhat}{\hat{R}}
\newcommand{\Lhat}{\hat{L}}
\newcommand{\nhat}{\hat{n}}
\newcommand{\xhattilde}{\hat{\tilde{x}}}
\newcommand{\phattilde}{\hat{\tilde{p}}}
\newcommand{\psitilde}{\tilde{\psi}}
\newcommand{\Psitilde}{\tilde{\Psi}}
\newcommand{\Thattilde}{\hat{\tilde{T}}}
\newcommand{\fancyL}{\mathcal{L}}
\newcommand{\fancyO}{\mathcal{O}}
\newcommand{\fancyP}{\mathcal{P}}
\newcommand{\fancyH}{\mathcal{H}}
\newcommand{\fancyF}{\mathcal{F}}
\newcommand{\fancyX}{\mathcal{X}}
\newcommand{\fancyG}{\mathcal{G}}
\newcommand{\fancyM}{\mathcal{M}}
\newcommand{\fancyA}{\mathcal{A}}
\newcommand{\fancyR}{\mathcal{R}}
\newcommand{\ahat}{\hat{a}}
\newcommand{\bhat}{\hat{b}}
\newcommand{\ehat}{\hat{e}}
\newcommand{\khat}{\hat{k}}
\newcommand{\spinup}{\left| \uparrow \right\rangle}
\newcommand{\spindown}{\left| \downarrow \right\rangle}
\newcommand{\spinupl}{\left\langle \uparrow \right|}
\newcommand{\spindownl}{\left\langle \downarrow \right|}
\newcommand{\spinupup}{\left| \uparrow \uparrow \right\rangle}
\newcommand{\spinupdown}{\left| \uparrow \downarrow \right\rangle}
\newcommand{\spindownup}{\left| \downarrow \uparrow \right\rangle}
\newcommand{\spindowndown}{\left| \downarrow \downarrow \right\rangle}
\newcommand{\spinupupl}{\left\langle \uparrow \uparrow \right|}
\newcommand{\spinupdownl}{\left\langle \uparrow \downarrow \right|}
\newcommand{\spindownupl}{\left\langle \downarrow \uparrow \right|}
\newcommand{\spindowndownl}{\left\langle \downarrow \downarrow \right|}
\newcommand{\pdiff}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\phibar}{\bar{\phi}}
%Multivar
\newcommand{\one}{\mathbbm{1}}
\newcommand{\vectwo}[2]{
\big(\begin{smallmatrix}
  #1\\
  #2
\end{smallmatrix}\big)
}

\newcommand{\vecthree}[3]{
\left(\begin{smallmatrix}
  #1\\
  #2\\
  #3
\end{smallmatrix}\right)
}


\newcommand{\vecfour}[4]{
\left(\begin{smallmatrix}
  #1\\
  #2\\
  #3\\
  #4
\end{smallmatrix}\right)
}

\newcommand{\vecsix}[6]{
\left(\begin{smallmatrix}
  #1\\
  #2\\
  #3\\
  #4\\
  #5\\
  #6
\end{smallmatrix}\right)
}

\newcommand{\vol}{\operatorname{vol}}
\newcommand{\var}{\operatorname{var}}
\newcommand{\tr}{\operatorname{tr}}
\newcommand{\proj}{\operatorname{proj}}
\newcommand{\eql}{\stackrel{L}{=}}
\newcommand{\defeq}{\stackrel{def}{=}}
\newcommand{\curl}{\nabla \times}
\newcommand{\divg}{\nabla \cdot}
\newcommand{\dvg}{\nabla \cdot}
\newcommand{\grad}{\nabla}

\newcommand{\diag}{\operatorname{diag}}
\newcommand{\Diag}{\operatorname{Diag}}
\newcommand{\One}{\mathbbm{1}} \)
   </p><div class='maketitle'>
                                                                                                
                                                                                                
                                                                                                
                                                                                                

<h1 class='titleHead'>Rendering the Visible Spectrum</h1>
              <div class='author'><span class='cmr-12x-x-120'>Brandon Li</span>
<br /> <span class='cmr-10x-x-109'>No AI was used in the writing of this text.</span></div><br />
<div class='date'><span class='cmr-12x-x-120'>January 26, 2026</span></div>
   </div>
   <h3 class='likesectionHead' id='contents'> <a id='x1-1000'></a>Contents</h3>
   <div class='tableofcontents'>
   <span class='sectionToc'>1 <a href='#intro' id='QQ2-1-2'>Intro</a></span>
<br />   <span class='sectionToc'>2 <a href='#the-laws-of-visual-perception' id='QQ2-1-3'>The laws of visual perception</a></span>
<br />   <span class='sectionToc'>3 <a href='#rgb-color-spaces' id='QQ2-1-4'>RGB color spaces</a></span>
<br />   <span class='sectionToc'>4 <a href='#color-profiles' id='QQ2-1-8'>Color profiles</a></span>
<br />   <span class='sectionToc'>5 <a href='#from-wavelength-to-rgb' id='QQ2-1-9'>From wavelength to RGB</a></span>
<br />   <span class='sectionToc'>6 <a href='#color-appearance-phenomena' id='QQ2-1-10'>Color appearance phenomena</a></span>
<br />   <span class='sectionToc'>7 <a href='#rendering-a-realistic-spectrum' id='QQ2-1-11'>Rendering a realistic spectrum</a></span>
<br />   <span class='sectionToc'>8 <a href='#whats-the-point' id='QQ2-1-13'>What’s the point?</a></span>
<br />   <span class='sectionToc'>9 <a href='#the-periodic-table-of-atomic-spectra' id='QQ2-1-14'>The periodic table of atomic spectra</a></span>
<br />   <span class='sectionToc'>10 <a href='#interesting-spectra' id='QQ2-1-16'>Interesting spectra</a></span>
   </div>
                                                                                                
                                                                                                
   
   <h3 class='sectionHead' id='intro'><span class='titlemark'>1   </span>   <a id='x1-20001'></a>Intro</h3>
<!-- l. 25 --><p class='indent'>   What’s the best way to display a rainbow on a computer? I first started thinking about this question after I
noticed that many popular depictions of the visible spectrum of light that I found on the internet didn’t
seem quite right. If I go on google and search up images of the visible spectrum, this is the first result that
appears: <span class='footnote-mark'><a href='#fn1x0' id='fn1x0-bk'><sup class='textsuperscript'>1</sup></a></span><a id='x1-2001f1'></a>
</p><figure class='figure'> 

                                                                                                
                                                                                                
                                                                                                
                                                                                                
<!-- l. 26 --><p class='noindent'><img alt='PIC' src='spectra/google.png' />
                                                                                                
                                                                                                
</p>
   </figure>
<!-- l. 28 --><p class='indent'>   If you’ve ever looked at white light through a prism or diffraction grating or have seen a rainbow, you
may notice that this image is far removed from what your eye actually sees. This image contains several
regions with very distinct colors: red, yellow, green, cyan, blue, and magenta. These regions seem to be
separated by very sharp color gradients. This is fictional. A real spectrum has colors that vary so smoothly
that it is almost impossible to tell one color apart from another. There are many more issues with this
image, such as colors taking up the wrong amount of space relative to each other and the brightness of
different wavelengths not corresponding to reality. I am not trying to criticize the author of this image, but
this is clearly an inaccurate depiction of the visible spectrum which is similar to many other
examples on the internet. The seriousness of this issue is conveyed by the fact that there is even a
Wikipedia talk page discussing this subject that contains many variants of the spectrum:
<span class='footnote-mark'><a href='#fn2x0' id='fn2x0-bk'><sup class='textsuperscript'>2</sup></a></span><a id='x1-2003f2'></a>
</p>
   <figure class='figure'> 

                                                                                                
                                                                                                
                                                                                                
                                                                                                
<!-- l. 30 --><p class='noindent'><img alt='PIC' src='spectra/wiki.png' />
                                                                                                
                                                                                                
</p>
   </figure>
<!-- l. 31 --><p class='indent'>   Many of these images exhibit the same issues of color banding, inaccurate hues, and incorrect brightness.
Some are better than others and a couple of them are actually quite accurate. The images that best match
what I see through my diffraction grating are the three that are rendered over a gray background and
contain rulers (6th-8th images from the left). I also really like the one from the Wikipedia page for color:
<span class='footnote-mark'><a href='#fn3x0' id='fn3x0-bk'><sup class='textsuperscript'>3</sup></a></span><a id='x1-2005f3'></a>
</p><figure class='figure'> 

                                                                                                
                                                                                                
                                                                                                
                                                                                                
<!-- l. 32 --><p class='noindent'><img alt='PIC' src='spectra/color_wiki.png' />
                                                                                                
                                                                                                
</p>
   </figure>
<!-- l. 34 --><p class='indent'>   Unfortunately, a lot of these images do not come with information about how they were made. This is
what led me to take matters into my own hands and then I set off on the quest to find the best way to
display a spectrum on my computer.
</p><!-- l. 36 --><p class='indent'>   It seems like such a simple task. Convert each wavelength to RGB coordinates and put these values
into an image file. Color perception, however, is anything but simple. It is so complicated because of the
many steps it takes to go from light entering our eyes to electrical signals in the brain and
finally the sensation of color. The reality is we have to factor in physics, biology, and even
psychology to get the most accurate model of color perception. In the rest of the essay I will ignore
psychology and focus mostly on physics, which will produce a result that I consider “good
enough”.
   
</p>
<!-- l. 38 --><p class='indent'>   <span style='display: hidden'>\(\nextSection \)</span></p><h3 class='sectionHead' id='the-laws-of-visual-perception'><span class='titlemark'>2   </span>   <a id='x1-30002'></a>The laws of visual perception</h3>
<!-- l. 39 --><p class='indent'>   We’ll start by taking a look at the fundamental laws that govern our perception of color. Warning: The
math will get heavy so it is okay to skim this section. Let’s first state what we mean by the word color.
Color is what we perceive when we look at a uniform region that emits light with a particular spectral
distribution. The reason is that every object that you can see emits a bunch of photons with different
wavelengths. The probability of an emitted photon having a specific wavelength is captured by the spectral
power distribution </p><div class='mathjax-env mathjax-gather'>\begin{gather} S(\lambda ) = \text {power at wavelength } \lambda \end{gather}</div><p><a id='x1-3001r1'></a> where <span class='mathjax-inline'>\(S(\lambda )\, d\lambda \)</span> gives the amount of electromagnetic energy emitted per unit time between
the wavelengths <span class='mathjax-inline'>\(\lambda \)</span> and <span class='mathjax-inline'>\(\lambda +d\lambda \)</span>. Dividing by <span class='mathjax-inline'>\(hf\)</span>, the energy of a photon, gives the number of photons in
this wavelength range. The spectral power distribution uniquely determines the color of an
object, as long as we ignore the effects of color contrast. Mathematically, we write the color
associated with a spectral distribution as <span class='mathjax-inline'>\(C[S]\)</span> where <span class='mathjax-inline'>\(C\)</span> is the function that takes a distribution and
outputs the corresponding color. Importantly, different distributions <span class='mathjax-inline'>\(S_1\)</span>, <span class='mathjax-inline'>\(S_2\)</span> can yield the same
color (<span class='mathjax-inline'>\(C[S_1] = C[S_2]\)</span>) when <span class='mathjax-inline'>\(S_1\)</span> and <span class='mathjax-inline'>\(S_2\)</span> are different from each other. This phenomenon is called metamerism. It
manifests when objects that are the same color under a light source become different when the
light source changes. Now, all the possible colors that <span class='mathjax-inline'>\(C\)</span> represents forms a mathematical set
called <span class='cmti-12'>color space</span>. The most important question we can ask is, how do we describe this set?
We can answer this question by looking at a set of fundamental physiological laws deduced
by Hermann Grassmann that describe how color perception works. Let us summarize these
laws:
<!-- l. 44 --></p><p class='indent'>   First, the perceived color continuously depends on the spectral distribution meaning small changes in <span class='mathjax-inline'>\(S\)</span>
cause small changes in <span class='mathjax-inline'>\(C[S]\)</span>.
</p><!-- l. 45 --><p class='indent'>   Next, if we have two sets of identical looking colors <span class='mathjax-inline'>\(C[P_1] = C[P_2], C[Q_1] = C[Q_2]\)</span> where <span class='mathjax-inline'>\(P_1\)</span> and <span class='mathjax-inline'>\(P_2\)</span> appear identical and likewise with <span class='mathjax-inline'>\(Q\)</span>,
then their combinations must also appear identical, ie. <span class='mathjax-inline'>\(C[P_1 + Q_1] = C[P_2 + Q_2]\)</span>. We will see that this means the set of perceptually
distinct spectral distributions forms a vector space (consisting of objects that can be added together). To
begin, we choose a particular spectrum <span class='mathjax-inline'>\(P\)</span> and define the set </p><div class='mathjax-env mathjax-gather'>\begin{gather} W = \{w:C[w+P] = C[P]\} \end{gather}</div><p><a id='x1-3002r2'></a> <span class='mathjax-inline'>\(W\)</span> consists of all spectra that when added to <span class='mathjax-inline'>\(P\)</span>,
does not change its perceived color (note that elements of <span class='mathjax-inline'>\(W\)</span> contain regions of negative intensity,
which is mathematically possible but physically impossible). Furthermore, <span class='mathjax-inline'>\(W\)</span> does not depend on
the choice of reference spectra <span class='mathjax-inline'>\(P\)</span>. Suppose we defined <span class='mathjax-inline'>\(W' = \{w:C[w+Q] = C[Q]\}\)</span> to use the alternate reference spectrum
<span class='mathjax-inline'>\(Q\)</span>. If <span class='mathjax-inline'>\(w \in W\)</span> then by the definition of <span class='mathjax-inline'>\(W\)</span>, </p><div class='mathjax-env mathjax-gather'>\begin{gather} C[w] = C[w+P-P] = C[P-P] = C[0]\\ \implies C[w] = C[0] \end{gather}</div><p><a id='x1-3003r3'></a> where <span class='mathjax-inline'>\(0\)</span> is the zero distribution corresponding to complete
blackness. By Grassmann’s laws, </p><div class='mathjax-env mathjax-gather'>\begin{gather} C[w+Q] = C[0+Q] = C[Q] \implies w \in W' \end{gather}</div><p><a id='x1-3004r4'></a> If <span class='mathjax-inline'>\(w \in W\)</span> then <span class='mathjax-inline'>\(w \in W'\)</span>. The logic works in reverse, meaning <span class='mathjax-inline'>\(W\)</span> and <span class='mathjax-inline'>\(W'\)</span> are the same
                                                                                                
                                                                                                
set. We can also see that if <span class='mathjax-inline'>\(w, v \in W\)</span> then <span class='mathjax-inline'>\(\alpha w + \beta v \in W\)</span> for any <span class='mathjax-inline'>\(\alpha \)</span> and <span class='mathjax-inline'>\(\beta \)</span>, so <span class='mathjax-inline'>\(W\)</span> forms a vector space, and it is in fact a
subspace of the set of all spectral distributions. Another way of looking at it is <span class='mathjax-inline'>\(W\)</span> is the set of all
distributions that appear black. Now that we have <span class='mathjax-inline'>\(W\)</span> we can take a complement <span class='mathjax-inline'>\(W^c\)</span> in the space of all
distributions which we call <span class='mathjax-inline'>\(V\)</span>. <span class='mathjax-inline'>\(V\)</span> is not necessarily unique. Linear algebra tells us we can uniquely write
any distribution <span class='mathjax-inline'>\(S\)</span> as <span class='mathjax-inline'>\(w+v\)</span> where <span class='mathjax-inline'>\(w\)</span> comes from <span class='mathjax-inline'>\(W\)</span> and <span class='mathjax-inline'>\(v\)</span> from <span class='mathjax-inline'>\(V\)</span>. We know by Grassmann’s laws that
<span class='mathjax-inline'>\(C[w+v] = C[0+v] = C[v]\)</span> therefore the perceived color of this distribution only depends on <span class='mathjax-inline'>\(v\)</span>. We therefore say that
the space <span class='mathjax-inline'>\(V\)</span> parametrizes the set of all colors. In addition, <span class='mathjax-inline'>\(C[S] = C[\pi (S)]\)</span> where <span class='mathjax-inline'>\(\pi (S)\)</span> projects the function <span class='mathjax-inline'>\(S\)</span> onto
the subspace <span class='mathjax-inline'>\(V\)</span>. We sometimes consider <span class='mathjax-inline'>\(V\)</span> to be the color space even though it is more accurate
to say <span class='mathjax-inline'>\(V\)</span> is a coordinate system that describes the true color space consisting of all values of
<span class='mathjax-inline'>\(C\)</span>.
<!-- l. 58 --></p><p class='indent'>   Grassmann’s next law states that color space is three dimensional, and what we mean is that <span class='mathjax-inline'>\(V\)</span> is three
dimensional. The way we know this can be summarized by an experiment. Suppose we take three sources
of light that have different colors and whose intensities can be adjusted. We call the spectral
distributions of these lights <span class='mathjax-inline'>\(P_r(\lambda ), P_g(\lambda ),\)</span> and <span class='mathjax-inline'>\(P_b(\lambda )\)</span>. Then suppose that we can make any desired color <span class='mathjax-inline'>\(c\)</span> by mixing
some amount of these three lights: <span class='mathjax-inline'>\(C[c] = C[R P_r + G P_g + B P_b]\)</span> meaning <span class='mathjax-inline'>\(C[\pi (c)] = C[R\pi (P_r) + G\pi (P_g) + B\pi (P_b)]\)</span>. This would mean that the entire color space <span class='mathjax-inline'>\(V\)</span>
is spanned by the three distributions <span class='mathjax-inline'>\(\pi (P_r), \pi (P_g),\)</span> and <span class='mathjax-inline'>\(\pi (P_b)\)</span> and hence <span class='mathjax-inline'>\(V\)</span> is three-dimensional. What we see
in real life is that if we choose <span class='mathjax-inline'>\(P_r, P_g,\)</span> and <span class='mathjax-inline'>\(P_b\)</span> to be red, green, and blue sources of light, we can mix
them to form most colors. The exception is a few colors require negative amounts of at least
one of these colors, but this does not change the conclusion that color space is, indeed, three
dimensional.
</p><!-- l. 59 --><p class='indent'>   With this knowledge, let us see how any wavelength of light is equivalent to a sum of three primaries.
Let’s consider a monochromatic light source at wavelength <span class='mathjax-inline'>\(\mu \)</span> with a certain amount of power. This light has
the spectral power distribution </p><div class='mathjax-env mathjax-gather'>\begin{gather} S_\mu (\lambda ) = \delta (\lambda - \mu ) \end{gather}</div><p><a id='x1-3005r5'></a> where <span class='mathjax-inline'>\(\delta \)</span> is a delta function and represents a highly concentrated
distribution that is localized around a single wavelength. We define <span class='mathjax-inline'>\(\bar r, \bar g,\)</span> and <span class='mathjax-inline'>\(\bar b\)</span> to the amounts of each primary
needed to match the color of this monochromatic light. In other words, the functions must satisfy the
equation </p><div class='mathjax-env mathjax-gather'>\begin{gather} C[\bar r(\mu )P_r(\lambda ) + \bar g(\mu )P_r(\lambda ) + \bar b(\mu )P_r(\lambda )] = C[S_\mu ] = C[\delta (\lambda - \mu )]\label {e2.0}. \end{gather}</div><p><a id='x1-3006r6'></a> We now consider the spectral power of an arbitrary light source denoted <span class='mathjax-inline'>\(S(\lambda )\)</span> - now without the <span class='mathjax-inline'>\(\mu \)</span>
and we ask how much of each primary is needed to produce this chosen color. We do this by
expanding the formula for <span class='mathjax-inline'>\(C[S]\)</span>. </p><div class='mathjax-env mathjax-gather'>\begin{gather} C[S] = C[S(\lambda )] = C\left [\int {S(\mu ) \delta (\lambda -\mu )\, d\mu }\right ]\label {e2.1}\\ = C\left [\int {S(\mu ) [\bar r(\mu ) P_r(\lambda )+ \bar g(\mu ) P_g(\lambda ) + \bar b(\mu ) P_b(\lambda )]\, d\mu } \right ]\label {e2.2}\\ = C\left [\int {S(\mu ) \bar r(\mu )\, d\mu } P_r(\lambda )+ \int {S(\mu ) \bar g(\mu )\, d\mu } P_g(\lambda ) + \int {S(\mu ) \bar b(\mu )\, d\mu } P_b(\lambda ) \right ] \end{gather}</div><p><a id='x1-3007r7'></a> The jump from <span class='mathjax-inline'>\(\eqref {e2.1}\)</span> to <span class='mathjax-inline'>\(\eqref {e2.2}\)</span> comes from combining Grassmann’s laws with
the relation <span class='mathjax-inline'>\(\eqref {e2.0}\)</span>. If we say that <span class='mathjax-inline'>\(R, G,\)</span> and <span class='mathjax-inline'>\(B\)</span> are the amounts of primaries needed to match <span class='mathjax-inline'>\(S\)</span>, then that
means </p><div class='mathjax-env mathjax-gather'>\begin{gather} C[S] = C[R P_r(\lambda ) + G P_g(\lambda ) + B P_b(\lambda )] \end{gather}</div><p><a id='x1-3008r8'></a> In order for the two equations to be equal, it must be the case that </p><div class='mathjax-env mathjax-gather'>\begin{gather} R = \int {S(\mu ) \bar r(\mu )\, d\mu },\\ G = \int {S(\mu ) \bar g(\mu )\, d\mu },\\ B = \int {S(\mu ) \bar b(\mu )\, d\mu }.\label {e2.3} \end{gather}</div><p><a id='x1-3009r9'></a> The functions <span class='mathjax-inline'>\(\bar r, \bar g,\)</span>
and <span class='mathjax-inline'>\(\bar b\)</span> are called the color matching functions (CMFs) corresponding to reference colors <span class='mathjax-inline'>\(P_r,\) \(P_g,\)</span> and
<span class='mathjax-inline'>\(P_b\)</span>. The color matching functions tell us how much of each primary is needed to match light
at a specific wavelength. By integrating the product of the CMFs and the spectral power
distribution, we find the amount of each primary needed to match any color we desire. By choosing a
particular set of primaries, we get a corresponding color space defined by the <span class='mathjax-inline'>\(R, G, B\)</span> values of each color
source.
   
<!-- l. 86 --></p><p class='indent'>   <span style='display: hidden'>\(\nextSection \)</span></p><h3 class='sectionHead' id='rgb-color-spaces'><span class='titlemark'>3   </span>   <a id='x1-40003'></a>RGB color spaces</h3>
<!-- l. 87 --><p class='indent'>   The color system used ubiquitously in the world today is called the CIE 1931 color space developed
by the International Commission on Illumination in said year and is derived from the basic
laws of perception we previously described. CIE 1931 defines three reference light sources
(the “RGB primaries”) to be pure \(700\) \(\mathrm {nm}\) red light, \(546.1\) \(\mathrm {nm}\) green light, and \(435.8\) \(\mathrm {nm}\) blue light each with different
intensities that make the CMFs have equal areas under their curves. These give rise to the
color matching functions <span class='mathjax-inline'>\(\bar r(\lambda )\)</span>, <span class='mathjax-inline'>\(\bar g(\lambda )\)</span>, and <span class='mathjax-inline'>\(\bar b(\lambda )\)</span> defined to be the amount of each light source required to
                                                                                                
                                                                                                
reproduce the given monochromatic light source with wavelength <span class='mathjax-inline'>\(\lambda \)</span>. The functions are shown below.
</p><figure class='figure' id='x1-4001r1'><span id='the-cie-rgb-color-matching-functions-'></span> 

                                                                                                
                                                                                                

                                                                                                
                                                                                                
<!-- l. 88 --><p class='noindent'><img alt='PIC' src='spectra/CIE1931_RGBCMF2.png' />
</p>
<figcaption class='caption'><span class='id'>Figure 1: </span><span class='content'>The CIE 1931 RGB color matching functions <span class='footnote-mark'><a href='#fn4x0' id='fn4x0-bk'><sup class='textsuperscript'>4</sup></a></span></span></figcaption><!-- tex4ht:label?: x1-4001r1  -->
                                                                                                
                                                                                                
   </figure>
<!-- l. 90 --><p class='indent'>   <a id='x1-4002f4'></a>
</p><!-- l. 92 --><p class='indent'>   There are in fact many variations of these color matching functions. The most accurate ones for our
purposes are not the original 1931 CMFs, but rather the CIE 2012 “physiologically relevant
CMFs” that are derived from experiments involving the cone cells in the human eye. The
choice of CMFs makes a big difference to the look of the final image. Given these CMFs, the
resulting <span class='mathjax-inline'>\(R, G, B\)</span> coordinates defined in equation <span class='mathjax-inline'>\(\eqref {e2.3}\)</span> are called the CIE RGB color space coordinates.
This is different from the RGB color space used in displays. We’ll discuss how to get there in
a moment. After the CIE RGB coordinate system was defined, its creators wanted a new
coordinate system that was easier to work with and so they created a new set of coordinates
called <span class='mathjax-inline'>\(X, Y, Z\)</span> that were equal to a linear transformation of the previous <span class='mathjax-inline'>\(R,G,B\)</span> coordinates. Specifically,
</p><div class='mathjax-env mathjax-gather'>\begin{gather} \bmt X\\Y\\Z\emt = \bmt 0.49 &amp; 0.31 &amp; 0.2 \\ 0.17697 &amp; 0.81240 &amp; 0.01063 \\ 0 &amp; 0.01 &amp; 0.99\emt \bmt R\\G\\B\emt . \end{gather}</div><p><a id='x1-4004r10'></a>
<!-- l. 96 --></p><p class='indent'>   These new coordinates correspond to a different set of color matching functions <span class='mathjax-inline'>\(\bar x, \bar y, \bar z\)</span> that are
related to <span class='mathjax-inline'>\(\bar r, \bar g,\)</span> and <span class='mathjax-inline'>\(\bar b\)</span> by the same matrix. They also correspond to a different hypothetical set of
light sources that are linear combinations of the RGB primaries. Most important advantage of
this new coordinate system to us is that <span class='mathjax-inline'>\(Y\)</span> corresponds to the luminance of the light source.
Luminance is roughly speaking our subjective perception of the intensity of a light source.
There is some ambiguity in how exactly it is defined, but for our purposes it corresponds to
the CIE <span class='mathjax-inline'>\(Y\)</span> coordinate which was chosen specifically to match the luminous efficiency function
<span class='mathjax-inline'>\(V(\lambda )\)</span>.
</p><!-- l. 97 --><p class='indent'>   There is a variant of the XYZ coordinate system in which the <span class='mathjax-inline'>\(X\)</span> and <span class='mathjax-inline'>\(Z\)</span> coordinates are replaced by <span class='mathjax-inline'>\(x\)</span> and <span class='mathjax-inline'>\(y\)</span>,
where </p><div class='mathjax-env mathjax-gather'>\begin{gather} x = \frac {X}{X+Y+Z},\quad y = \frac {Y}{X+Y+Z}, \end{gather}</div><p><a id='x1-4005r11'></a> and <span class='mathjax-inline'>\(Y\)</span> stays the same. The purpose of these xyY coordinates is to separate out the contributions of
hue, saturation, and brightness to a perceived color. The <span class='mathjax-inline'>\(x\)</span> and <span class='mathjax-inline'>\(y\)</span> coordinates together specify the hue and
saturation of a color, called the chroma, independently from the luminance <span class='mathjax-inline'>\(Y\)</span>. By varying <span class='mathjax-inline'>\(x\)</span> and <span class='mathjax-inline'>\(y\)</span> we get a
range of colors with different chromaticities while keeping brightness the same. For a fixed value
of <span class='mathjax-inline'>\(Y\)</span> we can look at the space of <span class='mathjax-inline'>\(x\)</span> and <span class='mathjax-inline'>\(y\)</span>, which gives us a <span class='cmti-12'>chromaticity diagram</span>, shown below.
</p><figure class='figure' id='x1-4006r2'><span id='the-chromaticity-diagram-with-x-and-y-plotted-on-each-axis-'></span> 

                                                                                                
                                                                                                

                                                                                                
                                                                                                
<!-- l. 102 --><p class='noindent'><img alt='PIC' src='spectra/CIExy_sRGB.png' />
</p>
<figcaption class='caption'><span class='id'>Figure 2: </span><span class='content'>The chromaticity diagram, with <span class='mathjax-inline'>\(x\)</span> and <span class='mathjax-inline'>\(y\)</span> plotted on each axis. <span class='footnote-mark'><a href='#fn5x0' id='fn5x0-bk'><sup class='textsuperscript'>5</sup></a></span></span></figcaption><!-- tex4ht:label?: x1-4006r2  -->
                                                                                                
                                                                                                
   </figure>
<!-- l. 103 --><p class='indent'>   <a id='x1-4007f5'></a>
</p><!-- l. 105 --><p class='indent'>   The <span class='mathjax-inline'>\(X,Y,Z\)</span> coordinate system is the standard way of encoding colors across a wide variety of industries. It is
linear, meaning the act of combining two sources of light corresponds to adding their XYZ coordinates. To
get to the RGB spaces used in computer imaging, we’ll look at an example. The canonical
color space used across the digital world is called sRGB. The definition of sRGB involves
assigning chromaticities to each primary color as well as the color white. We can put this in a
table:
</p>
   <div class='table'>
                                                                                                
                                                                                                
<!-- l. 107 --><p class='indent'>   </p><figure class='float'>
                                                                                                
                                                                                                
<div class='tabular'> <table class='tabular' id='TBL-2'><colgroup id='TBL-2-1g'><col id='TBL-2-1' /><col id='TBL-2-2' /><col id='TBL-2-3' /><col id='TBL-2-4' /><col id='TBL-2-5' /></colgroup><tr class='hline'><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-2-1-' style='vertical-align:baseline;'><td class='td11' id='TBL-2-1-1' style='white-space:normal; text-align:center;'>  </td><td class='td11' id='TBL-2-1-2' style='white-space:normal; text-align:center;'> Red  </td><td class='td11' id='TBL-2-1-3' style='white-space:normal; text-align:center;'> Green  </td><td class='td11' id='TBL-2-1-4' style='white-space:normal; text-align:center;'> Blue  </td><td class='td11' id='TBL-2-1-5' style='white-space:normal; text-align:center;'> White  </td></tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-2-2-' style='vertical-align:baseline;'><td class='td11' id='TBL-2-2-1' style='white-space:normal; text-align:center;'> x </td><td class='td11' id='TBL-2-2-2' style='white-space:normal; text-align:center;'> <span class='mathjax-inline'>\(0.64\)</span> </td><td class='td11' id='TBL-2-2-3' style='white-space:normal; text-align:center;'> <span class='mathjax-inline'>\(0.3\)</span> </td><td class='td11' id='TBL-2-2-4' style='white-space:normal; text-align:center;'> <span class='mathjax-inline'>\(0.15\)</span> </td><td class='td11' id='TBL-2-2-5' style='white-space:normal; text-align:center;'> <span class='mathjax-inline'>\(0.3127\)</span></td>
</tr><tr id='TBL-2-3-' style='vertical-align:baseline;'><td class='td11' id='TBL-2-3-1' style='white-space:normal; text-align:center;'> y  </td><td class='td11' id='TBL-2-3-2' style='white-space:normal; text-align:center;'>   <span class='mathjax-inline'>\(0.33\)</span>   </td><td class='td11' id='TBL-2-3-3' style='white-space:normal; text-align:center;'>   <span class='mathjax-inline'>\(0.6\)</span>   </td><td class='td11' id='TBL-2-3-4' style='white-space:normal; text-align:center;'>   <span class='mathjax-inline'>\(0.06\)</span>   </td><td class='td11' id='TBL-2-3-5' style='white-space:normal; text-align:center;'>    <span class='mathjax-inline'>\(0.3290\)</span>    </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td></tr></table>                                                                                           </div>
                                                                                                
                                                                                                
   </figure>
   </div>
<!-- l. 118 --><p class='indent'>   We can write the <span class='mathjax-inline'>\(xy\)</span> values of each color abstractly: </p><div class='table'>
                                                                                                
                                                                                                
<!-- l. 119 --><p class='indent'>   </p><figure class='float'>
                                                                                                
                                                                                                
<div class='tabular'> <table class='tabular' id='TBL-3'><colgroup id='TBL-3-1g'><col id='TBL-3-1' /><col id='TBL-3-2' /><col id='TBL-3-3' /><col id='TBL-3-4' /><col id='TBL-3-5' /></colgroup><tr class='hline'><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-3-1-' style='vertical-align:baseline;'><td class='td11' id='TBL-3-1-1' style='white-space:normal; text-align:center;'>  </td><td class='td11' id='TBL-3-1-2' style='white-space:normal; text-align:center;'> Red  </td><td class='td11' id='TBL-3-1-3' style='white-space:normal; text-align:center;'> Green  </td><td class='td11' id='TBL-3-1-4' style='white-space:normal; text-align:center;'> Blue  </td><td class='td11' id='TBL-3-1-5' style='white-space:normal; text-align:center;'> White  </td></tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-3-2-' style='vertical-align:baseline;'><td class='td11' id='TBL-3-2-1' style='white-space:normal; text-align:center;'> x </td><td class='td11' id='TBL-3-2-2' style='white-space:normal; text-align:center;'> <span class='mathjax-inline'>\(x_r\)</span> </td><td class='td11' id='TBL-3-2-3' style='white-space:normal; text-align:center;'> <span class='mathjax-inline'>\(x_g\)</span> </td><td class='td11' id='TBL-3-2-4' style='white-space:normal; text-align:center;'> <span class='mathjax-inline'>\(x_b\)</span> </td><td class='td11' id='TBL-3-2-5' style='white-space:normal; text-align:center;'> <span class='mathjax-inline'>\(x_w\)</span></td>
</tr><tr id='TBL-3-3-' style='vertical-align:baseline;'><td class='td11' id='TBL-3-3-1' style='white-space:normal; text-align:center;'> y  </td><td class='td11' id='TBL-3-3-2' style='white-space:normal; text-align:center;'>   <span class='mathjax-inline'>\(y_r\)</span>   </td><td class='td11' id='TBL-3-3-3' style='white-space:normal; text-align:center;'>   <span class='mathjax-inline'>\(y_g\)</span>   </td><td class='td11' id='TBL-3-3-4' style='white-space:normal; text-align:center;'>   <span class='mathjax-inline'>\(y_b\)</span>   </td><td class='td11' id='TBL-3-3-5' style='white-space:normal; text-align:center;'>    <span class='mathjax-inline'>\(y_w\)</span>    </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td></tr></table>                                                                                           </div>
                                                                                                
                                                                                                
   </figure>
   </div>
<!-- l. 130 --><p class='indent'>   This almost gives us what we need to assign XYZ coordinates to each primary. The only missing piece
of information is the luminance <span class='mathjax-inline'>\(Y\)</span>. We can deduce the luminance of each color by requiring that <span class='mathjax-inline'>\((R, G, B) = (1, 1, 1)\)</span>
corresponds to white. The convention is to give white itself a luminance of <span class='mathjax-inline'>\(1\)</span>. Transforming to XYZ
coordinates gives </p><div class='table'>
                                                                                                
                                                                                                
<!-- l. 131 --><p class='indent'>   </p><figure class='float'>
                                                                                                
                                                                                                
<div class='tabular'> <table class='tabular' id='TBL-4'><colgroup id='TBL-4-1g'><col id='TBL-4-1' /><col id='TBL-4-2' /><col id='TBL-4-3' /><col id='TBL-4-4' /><col id='TBL-4-5' /></colgroup><tr class='hline'><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-4-1-' style='vertical-align:baseline;'><td class='td11' id='TBL-4-1-1' style='white-space:normal; text-align:center;'>            </td><td class='td11' id='TBL-4-1-2' style='white-space:normal; text-align:center;'> Red  </td><td class='td11' id='TBL-4-1-3' style='white-space:normal; text-align:center;'> Green  </td><td class='td11' id='TBL-4-1-4' style='white-space:normal; text-align:center;'> Blue  </td><td class='td11' id='TBL-4-1-5' style='white-space:normal; text-align:center;'> White  </td></tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-4-2-' style='vertical-align:baseline;'><td class='td11' id='TBL-4-2-1' style='white-space:normal; text-align:center;'> X coordinate </td><td class='td11' id='TBL-4-2-2' style='white-space:normal; text-align:center;'> <span class='mathjax-inline'>\(Y_r \frac {x_r}{y_r}\)</span> </td><td class='td11' id='TBL-4-2-3' style='white-space:normal; text-align:center;'> <span class='mathjax-inline'>\(Y_g \frac {x_g}{y_g}\)</span> </td><td class='td11' id='TBL-4-2-4' style='white-space:normal; text-align:center;'> <span class='mathjax-inline'>\(Y_b \frac {x_b}{y_b}\)</span> </td><td class='td11' id='TBL-4-2-5' style='white-space:normal; text-align:center;'> <span class='mathjax-inline'>\(\frac {x_w}{y_w}\)</span></td>
</tr><tr id='TBL-4-3-' style='vertical-align:baseline;'><td class='td11' id='TBL-4-3-1' style='white-space:normal; text-align:center;'> Y coordinate  </td><td class='td11' id='TBL-4-3-2' style='white-space:normal; text-align:center;'>   <span class='mathjax-inline'>\(Y_r\)</span>   </td><td class='td11' id='TBL-4-3-3' style='white-space:normal; text-align:center;'>   <span class='mathjax-inline'>\(Y_g\)</span>   </td><td class='td11' id='TBL-4-3-4' style='white-space:normal; text-align:center;'>   <span class='mathjax-inline'>\(Y_b\)</span>   </td><td class='td11' id='TBL-4-3-5' style='white-space:normal; text-align:center;'>    <span class='mathjax-inline'>\(1\)</span>    </td>
</tr><tr id='TBL-4-4-' style='vertical-align:baseline;'><td class='td11' id='TBL-4-4-1' style='white-space:normal; text-align:center;'> Z coordinate  </td><td class='td11' id='TBL-4-4-2' style='white-space:normal; text-align:center;'>   <span class='mathjax-inline'>\(Y_r \frac {1-x_r-y_r}{y_r}\)</span>   </td><td class='td11' id='TBL-4-4-3' style='white-space:normal; text-align:center;'>   <span class='mathjax-inline'>\(Y_g \frac {1-x_g-y_g}{y_g}\)</span>   </td><td class='td11' id='TBL-4-4-4' style='white-space:normal; text-align:center;'>   <span class='mathjax-inline'>\(Y_b \frac {1-x_b-y_b}{y_b}\)</span>   </td><td class='td11' id='TBL-4-4-5' style='white-space:normal; text-align:center;'>    <span class='mathjax-inline'>\(\frac {1-x_w-y_w}{y_w}\)</span>    </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td></tr></table>                                                                               </div>
                                                                                                
                                                                                                
   </figure>
   </div>
<!-- l. 143 --><p class='indent'>   We now say that the sum of red, green, and blue is white. This translates to the matrix equation </p><div class='mathjax-env mathjax-gather'>\begin{gather} \bmt \frac {x_r}{y_r} &amp; \frac {x_g}{y_g} &amp; \frac {x_b}{y_b} \\ 1 &amp; 1 &amp; 1 \\ \frac {1-x_r-y_r}{y_r} &amp; \frac {1-x_g-y_g}{y_g} &amp; \frac {1-x_b-y_b}{y_b} \\ \emt \bmt Y_r \\ Y_g \\ Y_b \emt = \bmt \frac {x_w}{y_w} \\ 1 \\ \frac {1-x_w-y_w}{y_w}\emt . \end{gather}</div><p><a id='x1-4009r12'></a> We
can now invert this matrix to solve for <span class='mathjax-inline'>\(Y_r, Y_g,\)</span> and <span class='mathjax-inline'>\(Y_b\)</span>. We find <span class='mathjax-inline'>\((Y_r, Y_g, Y_b) = (0.2126, 0.7152, 0.0722)\)</span>. This then allows us to determine the XYZ values
and we see that </p><div class='mathjax-env mathjax-gather'>\begin{gather} \text {Red} \to XYZ = (0.4124, 0.2126, 0.0193)\\ \text {Green} \to XYZ = (0.3576, 0.7152, 0.1192)\\ \text {Blue} \to XYZ = (0.1805, 0.0722, 0.9505) \end{gather}</div><p><a id='x1-4010r13'></a> This means the sRGB coordinates and the XYZ coordinates are related by </p><div class='mathjax-env mathjax-gather'>\begin{gather} \bmt X \\ Y \\ Z \emt = \bmt 0.4124 &amp; 0.3576 &amp; 0.1805 \\ 0.2126 &amp; 0.7512 &amp; 0.0722 \\ 0.0193 &amp; 0.1192 &amp; 0.9505\emt \bmt R \\ G \\ B\emt \end{gather}</div><p><a id='x1-4011r14'></a>
In fact, there is another phenomenon called chromatic adaptation that we must factor in,
which is when the cone cells in the human eye modulate their sensitivity according to the
color of ambient light. This is accounted for in my code, but I won’t discuss it further here.
Now these <span class='mathjax-inline'>\((R,G,B)\)</span> coordinates are still <span class='cmti-12'>not </span>the same as the ones stored in image files. The final piece
of the puzzle is gamma correction. Applying gamma correction to these RGB coordinates
produces a new set of values which we call <span class='mathjax-inline'>\((R', G', B')\)</span> that are related to the original by a <span class='cmti-12'>transfer function
</span><span class='footnote-mark'><a href='#fn6x0' id='fn6x0-bk'><sup class='textsuperscript'>6</sup></a></span><a id='x1-4012f6'></a>: </p><div class='mathjax-env mathjax-gather'>\begin{gather} (R', G', B') = (R^{\frac {1}{2.2}}, G^{\frac {1}{2.2}}, B^{\frac {1}{2.2}}). \end{gather}</div><p><a id='x1-4014r15'></a> The <span class='mathjax-inline'>\((R', G', B')\)</span>
coordinates are what get stored in an image file. The reason this is done is to account for how
our eyes perceive brightness nonlinearly. We can distinguish changes in dark shades much
more easily than light shades because a linear increase in <span class='mathjax-inline'>\(R\)</span> has much more of a relative effect
when <span class='mathjax-inline'>\(R\)</span> is small. Switching to <span class='mathjax-inline'>\((R', G', B')\)</span> therefore provides more resolution in dark regions of the image
where the eye is more sensitive to variations in brightness. The function that maps between <span class='mathjax-inline'>\((R', G', B')\)</span>
and <span class='mathjax-inline'>\((R, G, B)\)</span> is in general called the transfer function and it depends on which color space we are
using.
<!-- l. 166 --></p><p class='indent'>   One very important detail is that the values of <span class='mathjax-inline'>\(R, G, B\)</span> and <span class='mathjax-inline'>\(R', G', B'\)</span> are always restricted to be between <span class='mathjax-inline'>\(0\)</span> and <span class='mathjax-inline'>\(1\)</span>. Colors
that have negative values of RGB or values greater than <span class='mathjax-inline'>\(1\)</span> are said to lie outside the RGB gamut, the
gamut referring to all the colors with allowed RGB values. The gamut can be plotted on the chromaticity
diagram, appearing as a triangular region, shown below. The central question explored here is how
to represent colors outside this gamut by colors within it and this is what we will discuss
later.
</p>
   <figure class='figure' id='x1-4015r3'><span id='srgb-gamut-on-the-chromaticity-diagram-with-white-point-marked-by-a-circle'></span> 

                                                                                                
                                                                                                

                                                                                                
                                                                                                
<!-- l. 168 --><p class='noindent'><img alt='PIC' src='spectra/rgb.png' />
</p>
<figcaption class='caption'><span class='id'>Figure 3: </span><span class='content'>sRGB gamut on the chromaticity diagram, with white point marked by a circle.</span></figcaption><!-- tex4ht:label?: x1-4015r3  -->
                                                                                                
                                                                                                
   </figure>
   
<!-- l. 170 --><p class='indent'>   <span style='display: hidden'>\(\nextSection \)</span></p><h3 class='sectionHead' id='color-profiles'><span class='titlemark'>4   </span>   <a id='x1-50004'></a>Color profiles</h3>
<!-- l. 171 --><p class='indent'>   I’ll take a brief moment to talk about the different color spaces in use today. The standard one is of
course sRGB, but many displays cover a wider range of colors than is allowed in sRGB. For example,
most modern displays produced by Apple operate in the DCI-P3 color space which has more
vivid greens and reds than sRGB and correspondingly has a larger gamut. When a computer
encounters an image that has a larger gamut than the display, it must find a way to map
a larger color space into a smaller one, which is the same problem that we will deal with.
I do not know the details of how this is typically done, but I wanted to mention it as it is
important.
</p><!-- l. 172 --><p class='indent'>   A choice I have to make every time I render an image is to decide which color space or color profile to
use. If I choose sRGB then the image will look the same on all displays, but because there are some
displays that have a much larger gamut, my final image won’t reach its full potential on those displays. If I
choose a wider gamut like P3, the final image will look great on wide gamut displays, but will be slightly
more inaccurate on ordinary sRGB displays. This of course, depends on the aforementioned mapping
algorithm.
</p><!-- l. 173 --><p class='indent'>   My final decision was to have all the visible spectra up to section <a href='#rendering-a-realistic-spectrum'>7<!-- tex4ht:ref: final  --></a> drawn in sRGB for consistency. As
for the periodic table of spectra, I used DCI-P3 simply because I wanted it to look as good as possible on
my wide-gamut display. Just to make sure this was all right, I also viewed the final image on an sRGB
display and found the colors didn’t noticeably shift, which justified my decision. Finally, the spectra in
section <a href='#interesting-spectra'>10<!-- tex4ht:ref: slist  --></a> are rendered in P3 as well.
</p>
<!-- l. 174 --><p class='indent'>   <span style='display: hidden'>\(\nextSection \)</span></p><h3 class='sectionHead' id='from-wavelength-to-rgb'><span class='titlemark'>5   </span>   <a id='x1-60005'></a>From wavelength to RGB</h3>
<!-- l. 175 --><p class='indent'>   We are finally ready to tackle the problem of rendering the visible spectrum. For each wavelength of
light, we can just use the color matching functions to get an XYZ coordinate and then convert it to sRGB.
</p><div class='mathjax-env mathjax-gather'>\begin{gather} \lambda \overset {\bar x, \bar y,\bar z}\longrightarrow \bmt X(\lambda ) \\ Y(\lambda ) \\ Z(\lambda )\emt \longrightarrow \bmt R(\lambda ) \\ G(\lambda ) \\ B(\lambda )\emt \end{gather}</div><p><a id='x1-6001r16'></a> The issue is of course that valid RGB coordinates must lie between <span class='mathjax-inline'>\(0\)</span> and <span class='mathjax-inline'>\(1\)</span> and the coordinates obtained
from spectral colors will always fall outside this range, sometimes by a large margin. We must find a way
to choose a point within the RGB gamut that most closely matches a pure spectral color. We must
do so in a way that preserves the brightness and hue of each color and produces a smooth
image. There is no one right way to do this but rather a variety of methods, some better than
others.
<!-- l. 180 --></p><p class='indent'>   The simplest approach is to mix the spectral color with a specified amount of gray background light.
This way of doing it is physically real. What I mean is you can replicate this process by shining a rainbow
of light onto a gray surface, and so this mathematical transformation corresponds to a thing you can do
in real life. We write this process as </p><div class='mathjax-env mathjax-gather'>\begin{gather} \bmt R\\ G\\ B\emt = \alpha \bmt R(\lambda ) \\ G(\lambda ) \\ B(\lambda )\emt + \beta \bmt R_\text {gray} \\ G_\text {gray} \\ B_\text {gray}\emt . \end{gather}</div><p><a id='x1-6002r17'></a> where <span class='mathjax-inline'>\(\alpha \)</span> and <span class='mathjax-inline'>\(\beta \)</span> specify the amounts of spectral light and
gray respectively. Let’s see what happens when we try to generate an image this way. We’ll
choose values of <span class='mathjax-inline'>\(\alpha \)</span> and <span class='mathjax-inline'>\(\beta \)</span> so that the combined color always falls into the RGB gamut. The result:
</p><figure class='figure'> 

                                                                                                
                                                                                                
                                                                                                
                                                                                                
<!-- l. 185 --><p class='noindent'><img alt='PIC' src='spectra/first.png' />
                                                                                                
                                                                                                
</p>
   </figure>
<!-- l. 187 --><p class='indent'>   This is all right. The main issue is that the colors look quite pale and desaturated. Can we do
better? Here is a list of other ways I came up with to make sure the colors remain in the
gamut.
</p>
      <ul class='itemize1'>
      <li class='itemize'>
      <!-- l. 190 --><p class='noindent'>Make <span class='mathjax-inline'>\(\beta \)</span> a function of <span class='mathjax-inline'>\(\lambda \)</span>. Adjust the amount of gray light for each wavelength until the combination is
      valid (“Auto set gray”): </p><div class='mathjax-env mathjax-gather'>\begin{gather} \bmt R\\ G\\ B\emt = \alpha \bmt R(\lambda ) \\ G(\lambda ) \\ B(\lambda )\emt + \beta (\lambda ) \bmt R_\text {gray} \\ G_\text {gray} \\ B_\text {gray}\emt . \end{gather}</div><a id='x1-6003r18'></a>  <figure class='figure'> 
 <img alt='PIC' src='spectra/gray.png' /> </figure>
      </li>
      <li class='itemize'>
      <!-- l. 195 --><p class='noindent'>Make <span class='mathjax-inline'>\(\alpha \)</span> depend on <span class='mathjax-inline'>\(\lambda \)</span> and adjust the amount of spectral light (“Auto set color”): </p><div class='mathjax-env mathjax-gather'>\begin{gather} \bmt R\\ G\\ B\emt = \alpha (\lambda ) \bmt R(\lambda ) \\ G(\lambda ) \\ B(\lambda )\emt + \beta \bmt R_\text {gray} \\ G_\text {gray} \\ B_\text {gray}\emt . \end{gather}</div><a id='x1-6004r19'></a>  <figure class='figure'> 
 <img alt='PIC' src='spectra/color.png' />
      </figure>
      </li>
      <li class='itemize'>
      <!-- l. 200 --><p class='noindent'>Interpolate between the spectral color and gray for each wavelength (“Auto mix”): </p><div class='mathjax-env mathjax-gather'>\begin{gather} \bmt R\\ G\\ B\emt = \alpha (\lambda ) \bmt R(\lambda ) \\ G(\lambda ) \\ B(\lambda )\emt + (1-\alpha (\lambda )) \bmt R_\text {gray} \\ G_\text {gray} \\ B_\text {gray}\emt . \end{gather}</div><a id='x1-6005r20'></a>  <figure class='figure'> 
 <img alt='PIC' src='spectra/mix.png' />
      </figure>
      </li>
      <li class='itemize'>
      <!-- l. 205 --><p class='noindent'>Interpolate between the spectral color and gray, but choose the gray to have the same luminance as
      the spectral color (“Auto mix equiluminant gray”).  </p><figure class='figure'> 
 <img alt='PIC' src='spectra/equi.png' /> </figure>
      </li></ul>
<!-- l. 208 --><p class='noindent'>Some of these techniques produce decent results. I prefer the “Auto mix” since it produces the most vibrant
output image, and the image looks quite nice. There is, however, a striking flaw with all of these pictures. I
saw it when I compared my result to a real spectrum that I created with my diffraction grating. Something
was off. The reds, oranges, yellows and greens seemed mostly accurate. When I got to blue, the there was
quite a noticeable difference. In my computer generated image, the part of the spectrum from \(420\) \(\mathrm {nm}\) to \(450\) \(\mathrm {nm}\) appears
tinted violet. In real life, however, this region of the spectrum was really a deep blue. I wondered what had
happened. It turns out I had failed to take into account the complexities of color perception. The CIE
XYZ color space is only meant to be used for color reproduction, that is, how to represent colors as
numbers and then using those numbers to recreate the very same color. In real life, when we
combine a color with gray, its hue shifts a little bit, and this is something that CIE XYZ
does not tell us about. So while my image was correct from a scientific perspective, it was not
the most subjectively accurate representation of the visible spectrum. To fix this, I had to
account for slight distortions in color perception that happen at the extreme edges of color
space.
   
                                                                                                
                                                                                                
</p>
<!-- l. 210 --><p class='indent'>   <span style='display: hidden'>\(\nextSection \)</span></p><h3 class='sectionHead' id='color-appearance-phenomena'><span class='titlemark'>6   </span>   <a id='x1-70006'></a>Color appearance phenomena</h3>
<!-- l. 211 --><p class='indent'>   There is quite a large list of effects that distort the perception of color. I will discuss three of them. The
first is the Bezold-Brücke shift. This describes the tendency of a color’s hue to depend on how bright it is.
As luminance is increased, violets tend to appear more blue than they actually are. Greens will appear
more yellow and reds will appear more orange.
</p><!-- l. 212 --><p class='indent'>   Next, the perceived luminance of a color depends on its saturation. This is known as the
Helmholtz-Kohlrausch effect. Two colors with the same <span class='mathjax-inline'>\(Y\)</span> value may seem to have different luminances. The
more saturated color is the one with greater apparent luminance.
</p><!-- l. 213 --><p class='indent'>   Finally, we come to the Abney effect, which states that the hue of a color shifts as saturation is
increased. This means that when interpolating between a spectral color and gray light as we did before,
the hue does not remain the same. It explains why when we mixed blue and gray light we got purple
instead of pale blue.
</p><!-- l. 214 --><p class='indent'>   The ideal way to solve these issues would be to use a color appearance model as our color space instead
of CIE XYZ. The entire purpose of a color appearance model is to account for these perceptual effects and
to give a mathematical description of color that most closely matches what we subjectively perceive. The
downside is, of course, that it is much more complicated and difficult to work with compared to XYZ.
The right approach would have been to select a color appearance model (CIECAM02 is the
standard), convert all our colors to this coordinate system, do the mixing in this coordinate
system and then convert back to RGB. That being said, I did not want to deal with all the
extra complexity that would have come along with this. Instead, I opted for a much simpler
approach.
</p><!-- l. 215 --><p class='indent'>   I ignored the Bezold-Brücke shift and the Helmholtz-Kohlrausch effect because they were not as
important or noticeable in practice. I manually corrected for the Abney effect by comparing the colors in
the computer generated image to real monochromatic hues produced from the emission spectra of gas
tubes and then shifting the colors in the image to cancel out the Abney effect. As I have normal color
vision, I assume that my final result would be agreeable with the general population even
though there are actually slight variations in color perception between individuals with normal
vision.
</p>
<!-- l. 216 --><p class='indent'>   <span style='display: hidden'>\(\nextSection \)</span></p><h3 class='sectionHead' id='rendering-a-realistic-spectrum'><span class='titlemark'>7   </span>   <a id='x1-80007'></a>Rendering a realistic spectrum</h3>
<!-- l. 217 --><p class='indent'>   To mitigate the Abney effect, I had to shift each wavelength by an amount that would counteract the
existing distortion. To find out how much shift was required, I looked at the Abney effect plotted on the xy
chromaticity diagram.  </p><figure class='figure' id='x1-8001r4'><span id='a-original-wavelength-b-interior-point-and-c-effective-wavelength-'></span> 

                                                                                                
                                                                                                

                                                                                                
                                                                                                
<!-- l. 218 --><p class='noindent'><img alt='PIC' src='spectra/adj.png' />
</p>
<figcaption class='caption'><span class='id'>Figure 4: </span><span class='content'>(A) original wavelength, (B) interior point, and (C) effective wavelength <span class='footnote-mark'><a href='#fn7x0' id='fn7x0-bk'><sup class='textsuperscript'>7</sup></a></span></span></figcaption><!-- tex4ht:label?: x1-8001r4  -->
                                                                                                
                                                                                                
   </figure>
<!-- l. 220 --><p class='indent'>   <a id='x1-8002f7'></a>
</p><!-- l. 222 --><p class='indent'>   In this diagram, each curved line represents a set of colors that all appear to have the same hue. The
direction of the curve determines if the hue shifts up or down as saturation is increased. An interesting
thing to note is that some regions of the diagram contain overlapping curves that go in opposite directions.
It seems like different sources give contradictory results. That’s not a big deal though since for now we just
want to roughly estimate the size of the Abney effect. To do this we overlay the RGB triangle onto the
diagram. Let’s pick a color, say \(460\) \(\mathrm {nm}\) blue. When we mix this with gray, the resulting color lands on a different
line than the one that goes through \(460\) \(\mathrm {nm}\). If we follow this new line all the way out to the spectral locus,
we see its endpoint sits at a shorter wavelength, hence mixing with gray gives a more violet
looking hue. We want to find the right wavelength such that when we mix it with gray, the
resulting hue is the same as that of pure \(460\) \(\mathrm {nm}\) light. To do this, we trace the equal hue curve until it
falls into the RGB triangle and call this the interior point. Then we take the straight line
between the gray point and the interior point and extend it until it touches the spectral locus at
a new wavelength, and in this case it lands at \(470\) \(\mathrm {nm}\). Then, if we mix this new wavelength with
gray, the result will have the same hue as \(460\) \(\mathrm {nm}\) light. We’ll call this the effective wavelength of
light.
</p><!-- l. 224 --><p class='indent'>   I proceeded to estimate the effective wavelength across the entire visible spectrum. Then if we replace
each wavelength with its effective wavelength and calculate the color, the result would seem much closer to
reality. The first result after the correction seemed quite good, the blues became much more bluer. After
this success, I conducted a much more stringent test. Since I have a few gas discharge tubes, I rendered a
bunch of emission spectra of gasses and compared them to the pure spectral lines I saw through a
diffraction grating.
</p>
   <figure class='figure'> 

                                                                                                
                                                                                                
                                                                                                
                                                                                                
<!-- l. 226 --><p class='noindent'><img alt='PIC' src='spectra/tube.png' />
                                                                                                
                                                                                                
</p>
   </figure>
<!-- l. 227 --><p class='indent'>   Since the lines from the tubes took on discrete wavelengths, their colors were much easier to compare
against my computer generated images. I found that the entire spectrum needed a bit more correction,
which I performed. Afterwards, I felt I had reached a point where I was mostly satisfied with my work.
Here is the final result:
</p>
   <figure class='figure'> 

                                                                                                
                                                                                                
                                                                                                
                                                                                                
<!-- l. 229 --><p class='noindent'><img alt='PIC' src='spectra/final.png' />
                                                                                                
                                                                                                
</p>
   </figure>
<!-- l. 231 --><p class='indent'>   This image is the closest approximation I could make of the spectrum. It’s not
perfect<span class='footnote-mark'><a href='#fn8x0' id='fn8x0-bk'><sup class='textsuperscript'>8</sup></a></span><a id='x1-8004f8'></a>,
but it does a decent job, in my opinion, of representing what the real thing looks like. I had achieved my
goal of rendering the spectrum of visible light and I learned a lot along the way. Here is another version
with discrete lines spaced \(5\) \(\mathrm {nm}\) apart:
</p>
   <figure class='figure'> 

                                                                                                
                                                                                                
                                                                                                
                                                                                                
<!-- l. 233 --><p class='noindent'><img alt='PIC' src='spectra/ruled.png' />
                                                                                                
                                                                                                
</p>
   </figure>
<!-- l. 235 --><p class='indent'>   The code I wrote can be found at <a class='url' href='../../spectrumrenderer'>brandonli.net/spectrumrenderer</a>. It comes as an installable file and it
is open source.
   
</p>
<!-- l. 237 --><p class='indent'>   <span style='display: hidden'>\(\nextSection \)</span></p><h3 class='sectionHead' id='whats-the-point'><span class='titlemark'>8   </span>   <a id='x1-90008'></a>What’s the point?</h3>
<!-- l. 238 --><p class='indent'>   You might wonder why we should go through all the trouble of making an extremely accurate picture
when there are already a bunch of others that seem good enough. You might bring up the fact that we
very often make use of “inaccurate” or oversimplified depictions of phenomena in science communication
and education. And often, teaching a simplified version of a concept is the best way to introduce it
to a student, in and this case you have to make sure the student is aware that what they’re
learning is a simplified version of the real thing that is stripped of all the complexities and
nuance. This is okay because here accuracy is being scarified for ease of learning, but what
about when making something as accurate as possible has no downsides? Such is the case with
pictures of the visible spectrum. Here there is an issue with choosing a random picture to
represent it. It may give the students the wrong idea of what the spectrum “should” look
like.
</p><!-- l. 239 --><p class='indent'>   Going back to the very first image from the introduction, a student who sees this as their first exposure
to the subject might get the false impression that the spectrum can be divided into bands of distinct
colors, which is as far from the truth as it gets. They might think that the spectrum runs from <span class='mathjax-inline'>\(380\)</span> to \(740\) \(\mathrm {nm}\) and
gets cut off beyond that point. Our picture, however, shows that the the brightness of light falls off
gradually at the boundaries meaning there is no hard boundary to the visible spectrum. These
distinctions may not always be stated outright, but they are implicit statements that the picture is
making and they have an impact on the viewer, whether the viewer is aware of it or not. When
someone is writing that article, they might not have the time or patience to go through all the
different variants of an image and assess which one is the best. In my opinion though, this is
something we as a whole should focus on more and something we should attach greater value
to.
   
</p>
<!-- l. 243 --><p class='indent'>   <span style='display: hidden'>\(\nextSection \)</span></p><h3 class='sectionHead' id='the-periodic-table-of-atomic-spectra'><span class='titlemark'>9   </span>   <a id='x1-100009'></a>The periodic table of atomic spectra</h3>
<!-- l. 244 --><p class='indent'>   One of the most useful and interesting outcomes of this project is that the code I wrote can
be used to render arbitrary spectral distributions, which means, for example, that we can
take data from a spectrometer and display it as accurately as possible. I decided to use my
tool to create a periodic table with the atomic emission spectrum of each element rendered
as a high resolution image. This kind of thing already exists and looking up “periodic table
of spectra” gives many such examples. That said, these mostly exhibit the same issues that
we’ve discussed above meaning they’re not ideal reference images for students or scientists
<span class='footnote-mark'><a href='#fn9x0' id='fn9x0-bk'><sup class='textsuperscript'>9</sup></a></span><a id='x1-10001f9'></a>. I thus
decided to make my own version to test out my new spectrum rendering technique.
</p>
                                                                                                
                                                                                                
   <figure class='figure' id='x1-10003r5'><span id='helium-my-favorite-atomic-spectrum'></span> 

                                                                                                
                                                                                                

                                                                                                
                                                                                                
<!-- l. 246 --><p class='noindent'><img alt='PIC' src='spectra/He.png' />
</p>
<figcaption class='caption'><span class='id'>Figure 5: </span><span class='content'>Helium, my favorite atomic spectrum.</span></figcaption><!-- tex4ht:label?: x1-10003r5  -->
                                                                                                
                                                                                                
   </figure>
<!-- l. 248 --><p class='indent'>   All of the data I used comes from NIST’s atomic spectra database
<span class='footnote-mark'><a href='#fn10x0' id='fn10x0-bk'><sup class='textsuperscript'>10</sup></a></span><a id='x1-10004f10'></a>. For
each element and each ionization state, NIST provides a list containing the wavelengths and intensities of
all the spectral lines. For example, the process of <span class='mathjax-inline'>\(e^- + \text {He}^+ \to \text {He}\)</span> generates the spectrum of He I (neutral helium), whose
data looks something like: </p><div class='table'>
                                                                                                
                                                                                                
<!-- l. 249 --><p class='indent'>   </p><figure class='float'>
                                                                                                
                                                                                                
<div class='tabular'> <table class='tabular' id='TBL-5'><colgroup id='TBL-5-1g'><col id='TBL-5-1' /><col id='TBL-5-2' /><col id='TBL-5-3' /></colgroup><tr class='hline'><td></td><td></td><td></td></tr><tr id='TBL-5-1-' style='vertical-align:baseline;'><td class='td11' id='TBL-5-1-1' style='white-space:normal; text-align:center;'> Ion  </td><td class='td11' id='TBL-5-1-2' style='white-space:normal; text-align:center;'> Observed Wavelength Air (nm)  </td><td class='td11' id='TBL-5-1-3' style='white-space:normal; text-align:center;'> Rel Int.  </td>
</tr><tr class='hline'><td></td><td></td><td></td></tr><tr id='TBL-5-2-' style='vertical-align:baseline;'><td class='td11' id='TBL-5-2-1' style='white-space:normal; text-align:center;'> He I  </td><td class='td11' id='TBL-5-2-2' style='white-space:normal; text-align:center;'>              <span class='mathjax-inline'>\(471.31457\)</span>              </td><td class='td11' id='TBL-5-2-3' style='white-space:normal; text-align:center;'>    <span class='mathjax-inline'>\(30\)</span>    </td>
</tr><tr id='TBL-5-3-' style='vertical-align:baseline;'><td class='td11' id='TBL-5-3-1' style='white-space:normal; text-align:center;'> He I  </td><td class='td11' id='TBL-5-3-2' style='white-space:normal; text-align:center;'>              <span class='mathjax-inline'>\(492.19313\)</span>              </td><td class='td11' id='TBL-5-3-3' style='white-space:normal; text-align:center;'>    <span class='mathjax-inline'>\(20\)</span>    </td>
</tr><tr id='TBL-5-4-' style='vertical-align:baseline;'><td class='td11' id='TBL-5-4-1' style='white-space:normal; text-align:center;'> He I  </td><td class='td11' id='TBL-5-4-2' style='white-space:normal; text-align:center;'>              <span class='mathjax-inline'>\(501.56783\)</span>              </td><td class='td11' id='TBL-5-4-3' style='white-space:normal; text-align:center;'>    <span class='mathjax-inline'>\(100\)</span>    </td>
</tr><tr class='hline'><td></td><td></td><td></td></tr></table>                                                                                       </div>
                                                                                                
                                                                                                
   </figure>
   </div>
<!-- l. 261 --><p class='indent'>   Given this data we can easily make a spectral power distribution for He I by adding together a bunch
of peaks at the observed wavelengths scaled by their relative intensity.
</p><!-- l. 262 --><p class='indent'>   There is a small difficulty that arises from most elements having multiple ionization states. Each ion
has its own distinct spectrum (eg. Xe I vs. Xe II) and each ion is present in different amounts inside a
discharge lamp, for example. There is no right way to determine how much each ion contributes unless we
perform an experiment. I still had to find a way to take all the ions into account, so I just went with a very
simple approach. I assume that the gas is at a very high temperature and in thermal equilibrium, and
hence the number of ions <span class='mathjax-inline'>\(N\)</span> is proportional to the Boltzmann factor: </p><div class='mathjax-env mathjax-gather'>\begin{gather} N(X^{+k}) \propto e^{-E_\text {ionization}/kT} \end{gather}</div><p><a id='x1-10006r21'></a> where <span class='mathjax-inline'>\(E_{\text {ionization}}\)</span> is the energy it takes to ionize
a neutral atom <span class='mathjax-inline'>\(X\)</span> to <span class='mathjax-inline'>\(X^{+k}\)</span> in the process <span class='mathjax-inline'>\(X\to k e^{-} + X^{+k}\)</span> and <span class='mathjax-inline'>\(T\)</span>, the temperature, is somewhat arbitrarily chosen. In the end, I
generated periodic tables for mixtures of all ions as well as individual ionization states from I to V. Some
elements don’t have recorded spectral lines, and are left blank. The images can be accessed here:
</p><div class='table'>
                                                                                                
                                                                                                
<!-- l. 267 --><p class='indent'>   </p><figure class='float'>
                                                                                                
                                                                                                
<div class='tabular'> <table class='tabular' id='TBL-6'><colgroup id='TBL-6-1g'><col id='TBL-6-1' /><col id='TBL-6-2' /></colgroup><tr class='hline'><td></td><td></td></tr><tr id='TBL-6-1-' style='vertical-align:baseline;'><td class='td11' id='TBL-6-1-1' style='white-space:normal; text-align:center;'>        All ions             </td><td class='td11' id='TBL-6-1-2' style='white-space:normal; text-align:center;'>   <a class='url' href='https://brandonli.net/spectra/all_ions'>https://brandonli.net/spectra/all_ions</a>     </td>
</tr><tr id='TBL-6-2-' style='vertical-align:baseline;'><td class='td11' id='TBL-6-2-1' style='white-space:normal; text-align:center;'>   Ionization I (Neutral)    </td><td class='td11' id='TBL-6-2-2' style='white-space:normal; text-align:center;'>  <a class='url' href='https://brandonli.net/spectra/ionization_i'>https://brandonli.net/spectra/ionization_i</a>  </td>
</tr><tr id='TBL-6-3-' style='vertical-align:baseline;'><td class='td11' id='TBL-6-3-1' style='white-space:normal; text-align:center;'> Ionization II (+1 charge)  </td><td class='td11' id='TBL-6-3-2' style='white-space:normal; text-align:center;'> <a class='url' href='https://brandonli.net/spectra/ionization_ii'>https://brandonli.net/spectra/ionization_ii</a>  </td>
</tr><tr id='TBL-6-4-' style='vertical-align:baseline;'><td class='td11' id='TBL-6-4-1' style='white-space:normal; text-align:center;'> Ionization III (+2 charge)  </td><td class='td11' id='TBL-6-4-2' style='white-space:normal; text-align:center;'> <a class='url' href='https://brandonli.net/spectra/ionization_iii'>https://brandonli.net/spectra/ionization_iii</a>  </td>
</tr><tr id='TBL-6-5-' style='vertical-align:baseline;'><td class='td11' id='TBL-6-5-1' style='white-space:normal; text-align:center;'> Ionization IV (+3 charge)  </td><td class='td11' id='TBL-6-5-2' style='white-space:normal; text-align:center;'> <a class='url' href='https://brandonli.net/spectra/ionization_iv'>https://brandonli.net/spectra/ionization_iv</a>  </td>
</tr><tr id='TBL-6-6-' style='vertical-align:baseline;'><td class='td11' id='TBL-6-6-1' style='white-space:normal; text-align:center;'> Ionization V (+4 charge)  </td><td class='td11' id='TBL-6-6-2' style='white-space:normal; text-align:center;'> <a class='url' href='https://brandonli.net/spectra/ionization_v'>https://brandonli.net/spectra/ionization_v</a>  </td>
</tr><tr class='hline'><td></td><td></td></tr></table>                                                                  </div>
                                                                                                
                                                                                                
   </figure>
   </div>
<!-- l. 281 --><p class='indent'>   Finally, I took spectrum measurements of all of my gas tubes and rendered them as images. I had
samples of all the non-radioactive noble gasses, mercury vapor, diatomic hydrogen, nitrogen, oxygen, and
chlorine, and a couple of compounds and air. The noble gasses and mercury all closely resembled their
reference spectra. Hydrogen was similar, but had a couple of other bands. The rest of the pure elements
(nitrogen, oxygen, and chlorine) look very different from their atomic spectra. Nitrogen’s spectrum only
contains molecular bands, which looks quite beautiful. Oxygen’s has a few prominent molecular bands
as well as a few faint lines from atomic oxygen. What’s unusual is that hydrogen, oxygen,
chlorine, <span class='mathjax-inline'>\(\text {CO}_2\)</span> and <span class='mathjax-inline'>\(\text {H}_2 \text {O}\)</span> all seem to share the same bands at <span class='mathjax-inline'>\(450, 482, 519, 560,\)</span> and \(609\) \(\mathrm {nm}\). My best explanation is that all of
these tubes are contaminated with molecular oxygen. In the case of chlorine, its tube was
barely working when I measured its spectrum and the tube died shortly after I completed the
measurement. The result was a particularly noisy and poor quality spectrum. Finally, the spectrum
of air strongly resembles nitrogen, which is expected since air is mostly made of nitrogen.
</p><div class='table'>
                                                                                                
                                                                                                
<!-- l. 282 --><p class='indent'>   </p><figure class='float'>
                                                                                                
                                                                                                
<div class='tabular'> <table class='tabular' id='TBL-7'><colgroup id='TBL-7-1g'><col id='TBL-7-1' /><col id='TBL-7-2' /></colgroup><tr class='hline'><td></td><td></td></tr><tr id='TBL-7-1-' style='vertical-align:baseline;'><td class='td11' id='TBL-7-1-1' style='white-space:normal; text-align:center;'> Measured spectra  </td><td class='td11' id='TBL-7-1-2' style='white-space:normal; text-align:center;'> <a class='url' href='https://brandonli.net/spectra/measured'>https://brandonli.net/spectra/measured</a>  </td>
</tr><tr class='hline'><td></td><td></td></tr></table>                                                                          </div>
                                                                                                
                                                                                                
   </figure>
   </div>
   
<!-- l. 291 --><p class='indent'>   <span style='display: hidden'>\(\nextSection \)</span></p><h3 class='sectionHead' id='interesting-spectra'><span class='titlemark'>10   </span>   <a id='x1-1100010'></a>Interesting spectra</h3>
<!-- l. 292 --><p class='indent'>   The following is a collection of spectra that include the results of section <a href='#rendering-a-realistic-spectrum'>7<!-- tex4ht:ref: final  --></a> in a wide gamut
color space as well as renders of spectrometer data collected from a bunch of light sources.
</p><figure class='figure' id='x1-11001r6'><span id='visible-spectrum-in-p-color-space'></span> 

                                                                                                
                                                                                                

                                                                                                
                                                                                                
<!-- l. 293 --><p class='noindent'><img alt='PIC' src='spectra/full_p3.png' />
</p>
<figcaption class='caption'><span class='id'>Figure 6: </span><span class='content'>Visible spectrum in P3 color space</span></figcaption><!-- tex4ht:label?: x1-11001r6  -->
                                                                                                
                                                                                                
   </figure>
   <figure class='figure' id='x1-11002r7'><span id='discrete-spectrum-in-p-color-space'></span> 

                                                                                                
                                                                                                

                                                                                                
                                                                                                
<!-- l. 294 --><p class='noindent'><img alt='PIC' src='spectra/ruled_p3.png' />
</p>
<figcaption class='caption'><span class='id'>Figure 7: </span><span class='content'>Discrete spectrum in P3 color space</span></figcaption><!-- tex4ht:label?: x1-11002r7  -->
                                                                                                
                                                                                                
   </figure>
   <figure class='figure' id='x1-11003r8'><span id='light-from-a-compact-flourescent-bulb'></span> 

                                                                                                
                                                                                                

                                                                                                
                                                                                                
<!-- l. 295 --><p class='noindent'><img alt='PIC' src='spectra/cfl.png' />
</p>
<figcaption class='caption'><span class='id'>Figure 8: </span><span class='content'>Light from a compact flourescent bulb</span></figcaption><!-- tex4ht:label?: x1-11003r8  -->
                                                                                                
                                                                                                
   </figure>
   <figure class='figure' id='x1-11004r9'><span id='light-from-the-blue-sky-note-the-fraunhofer-lines-dark-bands'></span> 

                                                                                                
                                                                                                

                                                                                                
                                                                                                
<!-- l. 296 --><p class='noindent'><img alt='PIC' src='spectra/daylight.png' />
</p>
<figcaption class='caption'><span class='id'>Figure 9: </span><span class='content'>Light from the blue sky. Note the Fraunhofer lines (dark bands).</span></figcaption><!-- tex4ht:label?: x1-11004r9  -->
                                                                                                
                                                                                                
   </figure>
   <figure class='figure' id='x1-11005r10'><span id='white-light-from-a-macbook-display'></span> 

                                                                                                
                                                                                                

                                                                                                
                                                                                                
<!-- l. 297 --><p class='noindent'><img alt='PIC' src='spectra/computer_display.png' />
</p>
<figcaption class='caption'><span class='id'>Figure 10: </span><span class='content'>White light from a MacBook display</span></figcaption><!-- tex4ht:label?: x1-11005r10  -->
                                                                                                
                                                                                                
   </figure>
   <figure class='figure' id='x1-11006r11'><span id='a-plasma-globe-filled-with-neon-and-xenon'></span> 

                                                                                                
                                                                                                

                                                                                                
                                                                                                
<!-- l. 298 --><p class='noindent'><img alt='PIC' src='spectra/plasmaball.png' />
</p>
<figcaption class='caption'><span class='id'>Figure 11: </span><span class='content'>A plasma globe filled with neon and xenon.</span></figcaption><!-- tex4ht:label?: x1-11006r11  -->
                                                                                                
                                                                                                
   </figure>
   <p><span style='display: hidden'>\(\nextSection \)</span></p><div class='footnotes'>     <aside class='footnotetext' role='doc-footnote'>
<!-- l. 25 --><p class='noindent'><a id='x1-2002x1'></a><span class='footnote-mark'><a href='#fn1x0-bk' id='fn1x0'><sup class='textsuperscript'>1</sup></a></span><span class='cmr-10'>Andrew Zimmerman Jones, “What Is the Visible Light Spectrum?”, </span><a class='url' href='https://www.thoughtco.com/the-visible-light-spectrum-2699036'><span class='cmr-10'>https://www.thoughtco.com/the-visible-light-spectrum-2699036</span></a></p></aside> 
 <aside class='footnotetext' role='doc-footnote'>
<!-- l. 28 --><p class='noindent'><a id='x1-2004x1'></a><span class='footnote-mark'><a href='#fn2x0-bk' id='fn2x0'><sup class='textsuperscript'>2</sup></a></span><a class='url' href='https://en.wikipedia.org/wiki/Talk:Visible_spectrum'><span class='cmr-10'>https://en.wikipedia.org/wiki/Talk:Visible</span>_<span class='cmr-10'>spectrum</span></a></p></aside> 
 <aside class='footnotetext' role='doc-footnote'>
<!-- l. 31 --><p class='noindent'><a id='x1-2006x1'></a><span class='footnote-mark'><a href='#fn3x0-bk' id='fn3x0'><sup class='textsuperscript'>3</sup></a></span><span class='cmr-10'>Wikimedia Commons contributors, “File:Visible spectrum 390-710 nm linear perceptual.svg,” </span><span class='cmti-10'>Wikimedia Commons</span><span class='cmr-10'>,</span>
<a class='url' href='https://commons.wikimedia.org/w/index.php?title=File:Visible_spectrum_390-710_nm_linear_perceptual.svg&amp;oldid=1143721371.'><span class='cmr-10'>https://commons.wikimedia.org/w/index.php?title=File:Visible</span>_<span class='cmr-10'>spectrum</span>_<span class='cmr-10'>390-710</span>_<span class='cmr-10'>nm</span>_<span class='cmr-10'>linear</span>_<span class='cmr-10'>perceptual.svg&amp;oldid=1143721371.</span></a></p></aside> 
 <aside class='footnotetext' role='doc-footnote'>
<!-- l. 90 --><p class='noindent'><a id='x1-4003x3'></a><span class='footnote-mark'><a href='#fn4x0-bk' id='fn4x0'><sup class='textsuperscript'>4</sup></a></span><span class='cmr-10'>Wikimedia Commons contributors, “File:Cones SMJ2 E.svg,” </span><span class='cmti-10'>Wikimedia Commons</span><span class='cmr-10'>,</span>
<a class='url' href='https://commons.wikimedia.org/w/index.php?title=File:Cones_SMJ2_E.svg&amp;oldid=876075350'><span class='cmr-10'>https://commons.wikimedia.org/w/index.php?title=File:Cones</span>_<span class='cmr-10'>SMJ2</span>_<span class='cmr-10'>E.svg&amp;oldid=876075350</span></a></p></aside> 
 <aside class='footnotetext' role='doc-footnote'>
<!-- l. 103 --><p class='noindent'><a id='x1-4008x3'></a><span class='footnote-mark'><a href='#fn5x0-bk' id='fn5x0'><sup class='textsuperscript'>5</sup></a></span><span class='cmr-10'>The luminance is actually not uniform in this diagram. The lower edge is darkened to better match how those colors
would appear in real life.</span></p></aside> 
 <aside class='footnotetext' role='doc-footnote'>
<!-- l. 161 --><p class='noindent'><a id='x1-4013x3'></a><span class='footnote-mark'><a href='#fn6x0-bk' id='fn6x0'><sup class='textsuperscript'>6</sup></a></span><span class='cmr-10'>The sRGB transfer function actually takes a slightly different form. What we have is a very close approximation of
it.</span></p></aside> 
  <aside class='footnotetext' role='doc-footnote'>
<!-- l. 220 --><p class='noindent'><a id='x1-8003x7'></a><span class='footnote-mark'><a href='#fn7x0-bk' id='fn7x0'><sup class='textsuperscript'>7</sup></a></span><span class='cmr-10'>Derived from: Wikimedia Commons contributors, “File:Purity-on-hue effect on CIE 1931 chromaticity diagram.png,” </span><span class='cmti-10'>Wikimedia Commons</span><span class='cmr-10'>,</span>
<a class='url' href='https://commons.wikimedia.org/w/index.php?title=File:Purity-on-hue_effect_on_CIE_1931_chromaticity_diagram.png&amp;oldid=672204469'><span class='cmr-10'>https://commons.wikimedia.org/w/index.php?title=File:Purity-on-hue</span>_<span class='cmr-10'>effect</span>_<span class='cmr-10'>on</span>_<span class='cmr-10'>CIE</span>_<span class='cmr-10'>1931</span>_<span class='cmr-10'>chromaticity</span>_<span class='cmr-10'>diagram.png&amp;oldid=672204469</span></a></p></aside> 
 <aside class='footnotetext' role='doc-footnote'>
<!-- l. 231 --><p class='noindent'><a id='x1-8005x7'></a><span class='footnote-mark'><a href='#fn8x0-bk' id='fn8x0'><sup class='textsuperscript'>8</sup></a></span><span class='cmr-10'>The biggest issue is that the luminance around </span><span class='mathjax-inline'>\(490\) </span><span class='cmr-10'>to </span>\(520\) \(\mathrm {nm}\) <span class='cmr-10'>is reduced. I am also not completely satisfied with the color of the
blue part of the spectrum.</span></p></aside> 
 <aside class='footnotetext' role='doc-footnote'>
<!-- l. 244 --><p class='noindent'><a id='x1-10002x9'></a><span class='footnote-mark'><a href='#fn9x0-bk' id='fn9x0'><sup class='textsuperscript'>9</sup></a></span><span class='cmr-10'>The best of the bunch is probably </span><a class='url' href='https://www.atomic-spectra.net'><span class='cmr-10'>www.atomic-spectra.net</span></a><span class='cmr-10'>, which is mostly color-accurate and impressively contains
hand-adjusted spectra for almost every element.</span></p></aside> 
 <aside class='footnotetext' role='doc-footnote'>
<!-- l. 248 --><p class='noindent'><a id='x1-10005x9'></a><span class='footnote-mark'><a href='#fn10x0-bk' id='fn10x0'><sup class='textsuperscript'>10</sup></a></span><a class='url' href='https://www.nist.gov/pml/atomic-spectra-database'><span class='cmr-10'>https://www.nist.gov/pml/atomic-spectra-database</span></a></p></aside> 
                                                                              </div>
 
</body> 
</html>